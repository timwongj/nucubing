!function(){"use strict";function a(a){a.when("/",{templateUrl:"/dist/components/home/home.html"}).when("/profile",{templateUrl:"/dist/components/profile/profile.html",controller:"ProfileController"}).when("/users",{templateUrl:"/dist/components/users/users.html",controller:"UsersController"}).when("/users/:facebook_id",{templateUrl:"/dist/components/profile/profile.html",controller:"ProfileController"}).when("/contest",{templateUrl:"/dist/components/contest/contest.html",controller:"ContestController"}).when("/contest/:event/entry",{templateUrl:"/dist/components/contestEntry/contestEntry.html",controller:"ContestEntryController"}).when("/contest/:event/timer",{templateUrl:"/dist/components/contestTimer/contestTimer.html",controller:"ContestTimerController"}).when("/contest/333fm",{templateUrl:"/dist/components/contestFmc/contestFmc.html",controller:"ContestFmcController"}).when("/contest/333mbf",{templateUrl:"/dist/components/contestMbld/contestMbld.html",controller:"ContestMbldController"}).when("/results",{templateUrl:"/dist/components/results/results.html",controller:"ResultsController"}).when("/links",{templateUrl:"/dist/components/links/links.html"}).when("/admin",{templateUrl:"/dist/components/admin/admin.html",controller:"AdminController"}).otherwise({redirectTo:"/"})}function b(a,b){var c=b("/user");a.user=c.get()}angular.module("nuCubingApp",["ui.bootstrap","ngRoute","ngResource","angularFileUpload"]),angular.module("nuCubingApp").config(["$routeProvider",a]).run(["$rootScope","$resource",b])}(),function(){function a(){return function(a,b){var c=[];return angular.forEach(a,function(a,b){a.key=b,c.push(a)}),c.sort(function(a,c){return a[b]>c[b]?1:-1}),c}}angular.module("nuCubingApp").filter("orderObjectBy",a)}(),function(){"use strict";function a(){return{333:{name:"Rubik's Cube",format:"avg5",displayedFormat:"avg of 5",result:"",index:0},444:{name:"4x4 Cube",format:"avg5",displayedFormat:"avg of 5",result:"",index:1},555:{name:"5x5 Cube",format:"avg5",displayedFormat:"avg of 5",result:"",index:2},222:{name:"2x2 Cube",format:"avg5",displayedFormat:"avg of 5",result:"",index:3},"333bf":{name:"3x3 blindfolded",format:"bo3",displayedFormat:"best of 3",result:"",index:4},"333oh":{name:"3x3 one-handed",format:"avg5",displayedFormat:"avg of 5",result:"",index:5},"333fm":{name:"3x3 fewest moves",format:"fmc",displayedFormat:"mean of 3",result:"",index:6},"333ft":{name:"3x3 with feet",format:"mo3",displayedFormat:"mean of 3",result:"",index:7},minx:{name:"Megaminx",format:"avg5",displayedFormat:"avg of 5",result:"",index:8},pyram:{name:"Pyraminx",format:"avg5",displayedFormat:"avg of 5",result:"",index:9},sq1:{name:"Square-1",format:"avg5",displayedFormat:"avg of 5",result:"",index:10},clock:{name:"Rubik's Clock",format:"avg5",displayedFormat:"avg of 5",result:"",index:11},skewb:{name:"Skewb",format:"avg5",displayedFormat:"avg of 5",result:"",index:12},666:{name:"6x6 Cube",format:"mo3",displayedFormat:"mean of 3",result:"",index:13},777:{name:"7x7 Cube",format:"mo3",displayedFormat:"mean of 3",result:"",index:14},"444bf":{name:"4x4 blindfolded",format:"bo3",displayedFormat:"best of 3",result:"",index:15},"555bf":{name:"5x5 blindfolded",format:"bo3",displayedFormat:"best of 3",result:"",index:16},"333mbf":{name:"3x3 multi blind",format:"mbld",displayedFormat:"",result:"",index:17}}}angular.module("nuCubingApp").factory("Events",a)}(),function(){"use strict";function a(a){return{convertResults:function(b){var c,d,e=[],f=this;return angular.forEach(b,function(b){var g=JSON.parse(b.data),h={name:b.firstName+" "+b.lastName,facebook_id:b.facebook_id,week:b.week,event:b.event,index:a[b.event].index};switch(a[b.event].format){case"avg5":h.best=f.calculateSingle(g.times,g.penalties),h.average=f.calculateAverage(g.times,g.penalties),h.details="",d=f.formatTimes(g.times,g.penalties),angular.forEach(d,function(a,b){h.details+=b==g.times.length-1?f.reformatTime(a):f.reformatTime(a)+", "}),c=h.average.split(":"),h.raw="DNF"==h.average?"DNF":c.length>1?60*parseFloat(c[0])+parseFloat(c[1]):parseFloat(c[0]);break;case"mo3":h.best=f.calculateSingle(g.times,g.penalties),h.average="555bf"==b.event||"444bf"==b.event?"":f.calculateMean(g.times,g.penalties),h.details="",d=f.formatTimes(g.times,g.penalties),angular.forEach(d,function(a,b){h.details+=b==g.times.length-1?f.reformatTime(a):f.reformatTime(a)+", "}),c=h.average.split(":"),h.raw="DNF"==h.average?"DNF":c.length>1?60*parseFloat(c[0])+parseFloat(c[1]):parseFloat(c[0]);break;case"bo3":h.best=f.calculateSingle(g.times,g.penalties),h.average="555bf"==b.event||"444bf"==b.event?"":f.calculateMean(g.times,g.penalties),h.details="",d=f.formatTimes(g.times,g.penalties),angular.forEach(d,function(a,b){h.details+=b==g.times.length-1?f.reformatTime(a):f.reformatTime(a)+", "}),c=h.best.split(":"),h.raw="DNF"==h.best?"DNF":c.length>1?60*parseFloat(c[0])+parseFloat(c[1]):parseFloat(c[0]);break;case"fmc":h.best=f.calculateFMCSingle(g.moves),h.average=f.calculateFMCMean(g.moves),h.details=g.moves[0]+", "+g.moves[1]+", "+g.moves[2],h.raw=h.average;break;case"mbld":"(DNF)"==g.dnf?(h.best="DNF",h.details="DNF"):(h.best=g.solved+"/"+g.attempted+" in "+g.time,h.details=h.best);var i=parseFloat(g.solved)-(parseFloat(g.attempted)-parseFloat(g.solved)),j=60*parseFloat(g.time.split(":")[0])+parseFloat(g.time.split(":")[1]);h.raw=i.toString()+j.toString()}e.push(h)}),e},compareResults:function(a,b){if(a){if("DNF"==a)return"DNF"==b?"DNF":b;if("DNF"==b)return a;var c,d,e=a.toString().split(":"),f=b.toString().split(":");return c=e.length>1?60*parseFloat(e[0])+parseFloat(e[1]):parseFloat(e[0]),d=f.length>2?60*parseFloat(f[0])+parseFloat(f[2]):parseFloat(f[0]),c>d?b:a}return b},compareMBLDResults:function(a,b){if(!a)return b;var c=parseInt(a.solved)-(parseInt(a.attempted)-parseInt(a.solved)),d=parseInt(b.solved)-(parseInt(b.attempted)-parseInt(b.solved)),e=this.formatTimes([a.time,b.time],["",""]);return c>d?a:d>c?b:e[0]<e[1]?a:e[0]>e[1]?b:a.attempted<b.attempted?a:b},calculateFMCSingle:function(a){var b="DNF";return angular.forEach(a,function(a){b="DNF"==b&&"DNF"!=a?a:b,b=parseFloat(a)<b&&"DNF"!=a?a:b}),b.toString()},calculateSingle:function(a,b){var c="DNF",d=this.formatTimes(a,b);return angular.forEach(d,function(a){c="DNF"!=a&&"DNF"==c?a:c,c="DNF"!=a&&parseFloat(a)<c?a:c}),"DNF"==c?"DNF":this.reformatTime(c)},calculateAverage:function(a,b){for(var c=0,d=0;d<b.length;d++)if("(DNF)"==b[d]&&(c++,c>1))return"DNF";var e,f,g,h,i=this.formatTimes(a,b);for("DNF"!=i[0]?(e=0,f=0,g=parseFloat(i[0]),h=parseFloat(i[0])):(e=1,f=1,g=parseFloat(i[1]),h=parseFloat(i[1])),d=0;d<i.length;d++){if("DNF"==i[d]){h=i[d],f=d;break}parseFloat(i[d])>h&&(h=parseFloat(i[d]),f=d)}angular.forEach(i,function(a,b){b!=f&&parseFloat(a)<g&&(g=parseFloat(a),e=b)}),0===e&&0===f&&(f=1);var j=0;angular.forEach(i,function(a,b){b!=e&&b!=f&&(j+=parseFloat(a))});var k=(j/(i.length-2)).toFixed(2);return this.reformatTime(k)},calculateFMCMean:function(a){for(var b=0,c=0;c<a.length;c++){if("DNF"==a[c])return"DNF";b+=a[c]}return(b/3).toFixed(2)},calculateMean:function(a,b){for(var c=0;c<b.length;c++)if("(DNF)"==b[c])return"DNF";var d=this.formatTimes(a,b),e=0;angular.forEach(d,function(a){e+=a});var f=(e/d.length).toFixed(2);return this.reformatTime(f)},formatTimes:function(a,b){var c=[];return angular.forEach(a,function(a,d){var e=a.split(":");c[d]=e.length>1?60*parseFloat(e[0])+parseFloat(e[1]):parseFloat(e[0]),"(DNF)"==b[d]||""===c[d]?c[d]="DNF":"(+2)"==b[d]&&(c[d]=parseFloat(c[d])+2)}),c},reformatTime:function(a){if(isNaN(a))return"DNF";if(parseFloat(a)<60)return(Math.floor(100*Number(a))/100).toString();var b=Math.floor(parseFloat(a)/60),c=Math.floor(100*Number(a)%6e3)/100;return 10>c?b+":0"+c:b+":"+c}}}angular.module("nuCubingApp").factory("Calculator",["Events",a])}(),function(){"use strict";function a(a,b){a.user=b.user,a.keydown=function(a){b.$broadcast("keydown",a)},a.keyup=function(a){b.$broadcast("keyup",a)}}angular.module("nuCubingApp").controller("NuCubingController",["$scope","$rootScope",a])}(),function(){"use strict";function a(a,b,c,d,e){var f=b("/user"),g=b("/users/:facebook_id"),h=b("/results");a.user=f.get(),a.events=d,c.facebook_id?a.userProfile=g.get({facebook_id:c.facebook_id}):a.userProfile=a.user,a.displayFormat="Week",a.resultsByWeek={},a.resultsByEvent={},a.personalBestsMap=a.events,a.personalBests=[];for(var i in a.personalBestsMap)a.personalBestsMap.hasOwnProperty(i)&&(a.personalBestsMap[i].single="",a.personalBestsMap[i].average="");a.userProfile.$promise.then(function(){var b=h.query({facebook_id:a.userProfile.facebook_id,status:"Completed"},function(){angular.forEach(b,function(b){var c=JSON.parse(b.data);switch(a.personalBestsMap[b.event].format){case"avg5":a.personalBestsMap[b.event].single=e.compareResults(a.personalBestsMap[b.event].single,e.calculateSingle(c.times,c.penalties)),a.personalBestsMap[b.event].average=e.compareResults(a.personalBestsMap[b.event].average,e.calculateAverage(c.times,c.penalties));break;case"mo3":case"bo3":a.personalBestsMap[b.event].single=e.compareResults(a.personalBestsMap[b.event].single,e.calculateSingle(c.times,c.penalties)),a.personalBestsMap[b.event].average="555bf"==b.event||"444bf"==b.event?"":e.compareResults(a.personalBestsMap[b.event].average,e.calculateMean(c.times,c.penalties));break;case"fmc":a.personalBestsMap[b.event].single=e.compareResults(a.personalBestsMap[b.event].single,e.calculateFMCSingle(c.moves)),a.personalBestsMap[b.event].average=e.compareResults(a.personalBestsMap[b.event].average,e.calculateFMCMean(c.moves));break;case"mbld":if("(DNF)"!=c.dnf){var d=e.compareMBLDResults(a.personalBestsMap[b.event].single,c);a.personalBestsMap[b.event].single=d.solved+"/"+d.attempted+" in "+d.time}}a.resultsByWeek[b.week]||(a.resultsByWeek[b.week]=[]),a.resultsByEvent[b.event]||(a.resultsByEvent[b.event]={name:a.events[b.event].name,index:a.events[b.event].index,results:[]});var f,g={event:a.events[b.event].name,week:b.week,index:a.events[b.event].index};switch(a.events[b.event].format){case"avg5":g.best=e.calculateSingle(c.times,c.penalties),g.average=e.calculateAverage(c.times,c.penalties),g.details="",f=e.formatTimes(c.times,c.penalties),angular.forEach(c.times,function(a,b){g.details+=b==c.times.length-1?e.reformatTime(f[b]):e.reformatTime(f[b])+", "});break;case"mo3":case"bo3":g.best=e.calculateSingle(c.times,c.penalties),g.average="555bf"==b.event||"444bf"==b.event?"":e.calculateMean(c.times,c.penalties),g.details="",f=e.formatTimes(c.times,c.penalties),angular.forEach(c.times,function(a,b){g.details+=b==c.times.length-1?e.reformatTime(f[b]):e.reformatTime(f[b])+", "});break;case"fmc":g.best=e.calculateFMCSingle(c.moves),g.average=e.calculateFMCMean(c.moves),g.details=c.moves[0]+", "+c.moves[1]+", "+c.moves[2];break;case"mbld":"(DNF)"==c.dnf?(g.best="DNF",g.details="DNF"):(g.best=c.solved+"/"+c.attempted+" in "+c.time,g.details=g.best)}a.resultsByWeek[b.week].push(g),a.resultsByEvent[b.event].results.push(g)}),angular.forEach(a.personalBestsMap,function(b){(b.single||b.average)&&a.personalBests.push({name:b.name,single:b.single,average:"DNF"==b.average?"":b.average,index:b.index})})})}),a.displayWeek=function(a){return a.substr(0,2)+"-"+a.substr(2,2)+"-20"+a.substr(4,2)}}angular.module("nuCubingApp").controller("ProfileController",["$scope","$resource","$routeParams","Events","Calculator",a])}(),function(){"use strict";function a(a,b){var c=b("/user"),d=b("/users/:facebook_id");a.user=c.get(),a.users=d.query()}angular.module("nuCubingApp").controller("UsersController",["$scope","$resource",a])}(),function(){"use strict";function a(a,b,c,d,e){var f=b("/user"),g=b("/weeks"),h=b("/results");a.user=f.get();var i=g.query();a.events=d,c.all([a.user.$promise,i.$promise]).then(function(){var b=h.query({week:i[0],facebook_id:a.user.facebook_id},function(){angular.forEach(b,function(b){if("Completed"==b.status){var c=JSON.parse(b.data);switch(a.events[b.event].format){case"avg5":a.events[b.event].result=e.calculateAverage(c.times,c.penalties);break;case"mo3":a.events[b.event].result=e.calculateMean(c.times,c.penalties);break;case"bo3":a.events[b.event].result=e.calculateSingle(c.times,c.penalties);break;case"fmc":a.events[b.event].result=e.calculateFMCMean(c.moves);break;case"mbld":a.events[b.event].result="(DNF)"==c.dnf?"DNF":c.solved+"/"+c.attempted+" in "+c.time}"DNF"!=a.events[b.event].result&&(a.events[b.event].result+=" "+a.events[b.event].displayedFormat)}else"In Progress"==b.status&&(a.events[b.event].result="In Progress")}),angular.forEach(a.events,function(a){""===a.result&&(a.result="Not Completed")})})}),a.entry=function(a){switch(a){case"333fm":window.location="#/contest/333fm";break;case"333mbf":window.location="#/contest/333mbf";break;default:window.location="#/contest/"+a+"/entry"}},a.timer=function(a){window.location="#/contest/"+a+"/timer"}}angular.module("nuCubingApp").controller("ContestController",["$scope","$resource","$q","Events","Calculator",a])}(),function(){"use strict";function a(a,b,c,d,e){var f=b("/user"),g=b("/weeks"),h=b("/results"),i=b("/scrambles");a.user=f.get();var j=g.query();a.events=e,a.events[d.event]?(a.eventId=d.event,a.event=a.events[d.event].name):window.location="#/contest",a.solves=[],a.changed=!1;var k=!1,l={times:["","","","",""],penalties:["","","","",""]},m=j.$promise.then(function(){m=i.query({week:j[0],event:a.eventId},function(){angular.forEach(m[0].scrambles,function(b,c){a.solves[c]={scramble:b}})})});c.all([a.user.$promise,j.$promise,m.$promise]).then(function(){var b=h.query({week:j[0],event:a.eventId,facebook_id:a.user.facebook_id},function(){b[0]&&(l=JSON.parse(b[0].data),angular.forEach(a.solves,function(a,b){a.time=l.times[b],a.penalty=l.penalties[b]})),k=!0})}),a.$watch("solves",function(){k&&(a.changed=!1,a.valid=!0,angular.forEach(a.solves,function(b,c){a.valid=""===b.time?!1:a.valid,a.changed=b.time!=l.times[c]||b.penalty!=l.penalties[c]?!0:a.changed}))},!0),a.back=function(){a.changed?confirm("You have unsaved changes, are you sure you want to go back?")&&(window.location="#/contest"):window.location="#/contest"},a.info=function(){alert("Info")},a.save=function(){var b={times:[],penalties:[]};angular.forEach(a.solves,function(a,c){b.times[c]=a.time||"",b.penalties[c]=a.penalty||""});var c=new h({event:a.eventId,week:j[0],status:"In Progress",data:JSON.stringify(b)});c.$save(function(){angular.forEach(a.solves,function(a,b){l.times[b]=a.time||"",l.penalties[b]=a.penalty||""}),a.changed=!1})},a.submit=function(){if(a.valid&&a.contestForm.$valid){var b={times:[],penalties:[]};angular.forEach(a.solves,function(a,c){b.times[c]=a.time||"",b.penalties[c]=a.penalty||""});var c=new h({event:a.eventId,week:j[0],status:"Completed",data:JSON.stringify(b)});c.$save(function(){window.location="#/contest"})}}}angular.module("nuCubingApp").controller("ContestEntryController",["$scope","$resource","$q","$routeParams","Events",a])}(),function(){"use strict";function a(a,b,c,d,e,f,g){var h=b("/user"),i=b("/weeks"),j=b("/results"),k=b("/scrambles");a.user=h.get();var l=i.query();a.events=f,a.events[d.event]?(a.eventId=d.event,a.event=a.events[d.event].name):window.location="#/contest",a.solves=[],a.changed=!1,a.valid=!1,a.index=0,a.result="",a.eventFormat="",a.done=!1;var m=!1,n={times:["","","","",""],penalties:["","","","",""]},o=l.$promise.then(function(){o=k.query({week:l[0],event:a.eventId},function(){angular.forEach(o[0].scrambles,function(b,c){a.solves[c]={scramble:b}}),a.scramble=a.solves[a.index].scramble})});c.all([a.user.$promise,l.$promise,o.$promise]).then(function(){var b=j.query({week:l[0],event:a.eventId,facebook_id:a.user.facebook_id},function(){b[0]&&(n=JSON.parse(b[0].data),angular.forEach(a.solves,function(b,c){if(b.time=n.times[c],b.penalty=n.penalties[c],b.displayedResult=b.time+" "+b.penalty,b.completed=""!==b.time,b.completed&&a.index==c)if(a.index<a.solves.length-1)a.index++,a.scramble=a.solves[a.index].scramble;else{a.done=!0;for(var d=[],e=[],f=0;f<a.solves.length;f++)d[f]=a.solves[f].time,e[f]=a.solves[f].penalty;switch(a.events[a.eventId].format){case"avg5":a.result=g.calculateAverage(d,e),a.eventFormat="Average of 5";break;case"mo3":a.result=g.calculateMean(d,e),a.eventFormat="Mean of 3";break;case"bo3":a.result=g.calculateSingle(d,e),a.eventFormat="Best of 3"}}})),m=!0})}),a.$watch("solves",function(){m&&(a.changed=!1,a.valid=!0,angular.forEach(a.solves,function(b,c){a.valid=""===b.time?!1:a.valid,a.changed=b.time!=n.times[c]||b.penalty!=n.penalties[c]?!0:a.changed}))},!0),a.back=function(){a.changed?confirm("You have unsaved changes, are you sure you want to go back?")&&(window.location="#/contest"):window.location="#/contest"},a.info=function(){alert("Info")},a.save=function(){var b={times:[],penalties:[]};angular.forEach(a.solves,function(a,c){b.times[c]=a.time||"",b.penalties[c]=a.penalty||""});var c=new j({event:a.eventId,week:l[0],status:"In Progress",data:JSON.stringify(b)});c.$save(function(){angular.forEach(a.solves,function(a,b){n.times[b]=a.time||"",n.penalties[b]=a.penalty||""}),a.changed=!1})},a.submit=function(){if(a.valid){var b={times:[],penalties:[]};angular.forEach(a.solves,function(a,c){b.times[c]=a.time||"",b.penalties[c]=a.penalty||""});var c=new j({event:a.eventId,week:l[0],status:"Completed",data:JSON.stringify(b)});c.$save(function(){window.location="#/contest"})}},a.now=0,a.time=0,a.timer_display="0.00",a.timerDelay=10,a.interval=null,a.isTiming=0,a.isKeydown=0,a.$on("keydown",function(b,c){if(32===c.which&&0===a.isKeydown&&!a.done)if(a.isKeydown=1,0===a.isTiming)a.timer_display="0.00",a.timerStyle={color:"#33CC00"};else if(1===a.isTiming){if(a.stopTimer(),a.solves[a.index].time=g.reformatTime(a.time/1e3),a.solves[a.index].displayedResult=a.solves[a.index].time,a.solves[a.index].completed=!0,a.index<a.solves.length-1)for(;a.solves[a.index].completed===!0&&a.index<a.solves.length-1;)a.index++,a.scramble=a.solves[a.index].scramble;else{a.done=!0;for(var d=[],e=[],f=0;f<a.solves.length;f++)d[f]=a.solves[f].time,e[f]=a.solves[f].penalty;switch(a.events[a.eventId].format){case"avg5":a.result=g.calculateAverage(d,e),a.eventFormat="Average of 5";break;case"mo3":a.result=g.calculateMean(d,e),a.eventFormat="Mean of 3";break;case"bo3":a.result=g.calculateSingle(d,e),a.eventFormat="Best of 3"}}a.now=0,a.time=0,a.interval=null}}),a.$on("keyup",function(b,c){32!==c.which||1!==a.isKeydown||a.done||(a.isKeydown=0,0===a.isTiming?(a.isTiming=1,a.timerStyle={color:"black"},a.startTimer()):1===a.isTiming&&(a.isTiming=0))}),a.startTimer=function(){a.now=Date.now(),a.interval=e(function(){var b=Date.now(),c=b-a.now;a.time+=c,a.timer_display=g.reformatTime(a.time/1e3),a.now=b},a.timerDelay)},a.stopTimer=function(){e.cancel(a.interval)},a.updateResultWithPenalty=function(a,b){a.penalty=b,a.displayedResult=a.time+" "+b}}angular.module("nuCubingApp").controller("ContestTimerController",["$scope","$resource","$q","$routeParams","$interval","Events","Calculator",a])}(),function(){"use strict";function a(a,b,c){var d=b("/user"),e=b("/weeks"),f=b("/results"),g=b("/scrambles");a.user=d.get();var h=e.query();a.solves=[],a.changed=!1,a.valid=!1;var i=!1,j={solutions:["","",""],moves:[]},k=h.$promise.then(function(){k=g.query({week:h[0],event:"333fm"},function(){angular.forEach(k[0].scrambles,function(b,c){a.solves[c]={scramble:b}})})});c.all([a.user.$promise,h.$promise,k.$promise]).then(function(){var b=f.query({week:h[0],event:"333fm",facebook_id:a.user.facebook_id},function(){b[0]&&(j=JSON.parse(b[0].data),angular.forEach(a.solves,function(a,b){a.solution=j.solutions[b],a.moves=j.moves[b]})),i=!0})}),a.update=function(b){b.valid=0!==b.solution.length,b.moves=b.solution.split(" ").length,a.valid=!0,angular.forEach(a.solves,function(b,c){a.valid=b.valid?a.valid:!1})},a.$watch("solves",function(){i&&(a.changed=!1,a.valid=!0,angular.forEach(a.solves,function(b,c){a.valid=""===b.solution?!1:a.valid,a.changed=b.solution!=j.solutions[c]?!0:a.changed}))},!0),a.back=function(){a.changed?confirm("You have unsaved changes, are you sure you want to go back?")&&(window.location="#/contest"):window.location="#/contest"},a.info=function(){alert("Info")},a.save=function(){var b={solutions:[],moves:[]};angular.forEach(a.solves,function(a,c){b.solutions[c]=a.solution,b.moves[c]=a.moves});var c=new f({event:"333fm",week:h[0],status:"In Progress",data:JSON.stringify(b)});c.$save(function(){angular.forEach(a.solves,function(a,b){j.solutions[b]=a.solution,j.moves[b]=a.moves}),a.changed=!1})},a.submit=function(){var b={solutions:[],moves:[]};angular.forEach(a.solves,function(a,c){b.solutions[c]=a.solution,b.moves[c]=a.moves});var c=new f({event:"333fm",week:h[0],status:"Completed",data:JSON.stringify(b)});c.$save(function(){window.location="#/contest"})}}angular.module("nuCubingApp").controller("ContestFmcController",["$scope","$resource","$q",a])}(),function(){"use strict";function a(a,b,c){var d=b("/user"),e=b("/weeks"),f=b("/results"),g=b("/scrambles");a.user=d.get();var h=e.query();a.scrambles=[],a.displayed=7,a.mbldResult={solved:"",attempted:"",time:"",dnf:""},a.valid=!1;var i=!1,j={solved:"",attempted:"",time:"",dnf:""};a.changed=!1;var k=h.$promise.then(function(){k=g.query({week:h[0],event:"333mbf"},function(){angular.forEach(k[0].scrambles,function(b,c){a.scrambles[c]=b})})});c.all([a.user.$promise,h.$promise,k.$promise]).then(function(){var b=f.query({week:h[0],event:"333mbf",facebook_id:a.user.facebook_id},function(){b[0]&&(j=JSON.parse(b[0].data),a.mbldResult={solved:j.solved,attempted:j.attempted,time:j.time}),i=!0})}),a.display=function(b){switch(b){case"more":a.displayed<a.scrambles.length&&(a.displayed+=7);break;case"less":a.displayed>7&&(a.displayed-=7)}},a.update=function(){var b=parseInt(a.mbldResult.solved),c=parseInt(a.mbldResult.attempted);if(a.valid=a.mbldContestForm.$valid&&c>=b&&c<=a.scrambles.length,a.valid){var d=b-(c-b);if(d>=0&&c>2||d>0&&2==c){var e=a.mbldResult.time.split(":");e[0]&&e[1]&&(a.mbldResult.dnf=parseInt(e[0])<60||60===parseInt(e[0])&&0===parseInt(e[1])?"":"(DNF)")}else a.mbldResult.dnf="(DNF)"}},a.$watch("mbldResult",function(){i&&(a.mbldResult.solved=void 0===a.mbldResult.solved?"":a.mbldResult.solved,a.mbldResult.attempted=void 0===a.mbldResult.attempted?"":a.mbldResult.attempted,a.changed=a.mbldResult.solved!=j.solved||a.mbldResult.attempted!=j.attempted||a.mbldResult.time!=j.time,a.update())},!0),a.$watch("mbldContestForm.$valid",function(){a.update()}),a.back=function(){a.changed?confirm("You have unsaved changes, are you sure you want to go back?")&&(window.location="#/contest"):window.location="#/contest"},a.info=function(){alert("Info")},a.save=function(){var b=new f({event:"333mbf",week:h[0],status:"In Progress",data:{}});b.data.solved=a.mbldResult.solved,b.data.attempted=a.mbldResult.attempted,b.data.time=a.mbldResult.time,b.data.dnf=a.mbldResult.dnf,b.data=JSON.stringify(b.data),b.$save(function(){j={solved:a.mbldResult.solved,attempted:a.mbldResult.attempted,time:a.mbldResult.time},a.changed=!1})},a.submit=function(){var b=new f({event:"333mbf",week:h[0],status:"Completed",data:{}});b.data.solved=a.mbldResult.solved,b.data.attempted=a.mbldResult.attempted,b.data.time=a.mbldResult.time,b.data.dnf=a.mbldResult.dnf,b.data=JSON.stringify(b.data),b.$save(function(){window.location="#/contest"})}}angular.module("nuCubingApp").controller("ContestMbldController",["$scope","$resource","$q",a])}(),function(){"use strict";function a(a,b,c,d){function e(b,d){"All Weeks"==b?"All Events"==d?i.query({status:"Completed"},function(b){var d=c.convertResults(b),e=[];angular.forEach(d,function(c,d){var f=!1;angular.forEach(e,function(a){b[d].week==a.week&&b[d].event==a.event&&(f=!0,a.results.push(c))}),f||e.push({week:b[d].week,event:b[d].event,results:[c],index:a.events[c.event].index})}),a.displayedResults=e}):i.query({event:d,status:"Completed"},function(b){var e=c.convertResults(b),f=[];angular.forEach(e,function(a,c){var e=!1;angular.forEach(f,function(d){b[c].week==d.week&&(e=!0,d.results.push(a))}),e||f.push({week:b[c].week,event:d,results:[a],index:0})}),a.displayedResults=f}):"All Events"==d?i.query({week:b,status:"Completed"},function(d){var e=c.convertResults(d),f=[];angular.forEach(e,function(c,e){var g=!1;angular.forEach(f,function(a){d[e].event==a.event&&(g=!0,a.results.push(c))}),g||f.push({week:b,event:d[e].event,results:[c],index:a.events[c.event].index})}),a.displayedResults=f}):i.query({week:b,event:d,status:"Completed"},function(e){var f=c.convertResults(e),g={week:b,event:d,results:f,index:a.events[d]?a.events[d].index:0};a.displayedResults=e[0]?[g]:[]})}a.eventsList=["All Events","333","444","555","222","333bf","333oh","333fm","333ft","minx","pyram","sq1","clock","skewb","666","777","444bf","555bf","333mbf"],a.selectedEvent=a.eventsList[0];var f=!1,g=b("/user"),h=b("/weeks"),i=b("/results");a.user=g.get(),a.events=d,a.weeksList=h.query(function(){a.weeksList.unshift("All Weeks"),a.selectedWeek=a.weeksList[1]?a.weeksList[1]:a.weeksList[0],f=!0}),a.$watchGroup(["selectedWeek","selectedEvent"],function(){f&&e(a.selectedWeek,a.selectedEvent)}),a.displayEvent=function(b){return"All Events"===b||void 0===b?b:a.events[b].name},a.displayWeek=function(a){return"All Weeks"===a||void 0===a?a:a.substr(0,2)+"-"+a.substr(2,2)+"-20"+a.substr(4,2)}}angular.module("nuCubingApp").controller("ResultsController",["$scope","$resource","Calculator","Events",a])}(),function(){"use strict";function a(a,b,c,d){var e=b("/user"),f=b("/scrambles");a.user=e.get(),a.events=c,a.scrambles=f.query(function(){angular.forEach(a.scrambles,function(b){b.index=a.events[b.event].index})}),a.uploader=new d({url:"/scrambles"}),a.uploader.onSuccessItem=function(b,c){a.scrambles=f.query(function(){angular.forEach(a.scrambles,function(b){b.index=a.events[b.event].index})})},a.displayEvent=function(b){return a.events[b].name},a.displayWeek=function(a){return a.substr(0,2)+"-"+a.substr(2,2)+"-20"+a.substr(4,2)}}angular.module("nuCubingApp").controller("AdminController",["$scope","$resource","Events","FileUploader",a])}();